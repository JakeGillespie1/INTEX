<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, shrink-to-fit=no"
        />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Login Page</title>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
        <!-- Bootstrap icons-->
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css"
            rel="stylesheet"
            type="text/css"
        />
        <!-- Google fonts-->
        <link
            href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic"
            rel="stylesheet"
            type="text/css"
        />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="/css/styles.css" rel="stylesheet" />
    </head>
    <!-- Onload call set up page function -->
    <body onload="setupPage();">
        <!-- Navigation-->
        <nav class="navbar navbar-light bg-light static-top">
            <div class="container">
                <a class="navbar-brand" href="/"
                    ><img
                        src="/assets/img/provo welcome.png"
                        height="100"
                        alt="Welcome Provo Icon"
                /></a>
            </div>
        </nav>
        <!-- Masthead-->
        <header class="masthead" id="Login">
            <div class="container position-relative">
                <div class="row justify-content-center">
                    <div class="col-xl-6">
                        <div class="text-center text-white">
                            <h1 class="mb-5">Registration Form</h1>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <!-- Image Showcases-->
        <section class="showcase">
            <div class="row justify-content-center">
                <div class="col-xl-10 col-lg-12 col-md-9">
                    <div class="card o-hidden border-0 shadow-lg my-5">
                        <div class="card-body p-0">
                            <!-- Nested Row within Card Body -->
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="p-5">
                                        <h1 class="h4 text-gray-900 mb-4" id="emailBroke" style="display: none; color: orange; text-align: center;">
                                            <%= message %>
                                        </h1>
                                        <h1 class="h4 text-gray-900 mb-4" id="emailBroke2" style="display: none; color: orange; text-align: center;">
                                            Error: Invalid email
                                        </h1>
                                        <h1 class="h4 text-gray-900 mb-4" id="pwBroke" style="display: none; color: orange; text-align: center;">
                                            Error: Passwords do not match
                                        </h1>
                                        <!-- Input boxes for users. -->
                                        <!-- First and last name input. When a user types their name it will auto-capitalize the first letter. -->
                                        <form action="/addUser" method="post">
                                            <input class="form-control form-control-user" 
                                            type="text" 
                                            id="FirstName" 
                                            placeholder="First Name"
                                            name="FirstName"
                                            maxlength="30"
                                            onkeyup= "properCaseInsert(this);"
                                            required>
                                        <br><br>
                                            <input class="form-control form-control-user" 
                                            type="text" 
                                            id="LastName" 
                                            placeholder="Last Name" 
                                            name="LastName"
                                            maxlength="30"
                                            onkeyup="properCaseInsert(this);"
                                            required>
                                        <br><br>
                                        <!-- Email input -->
                                            <input class="form-control form-control-user" 
                                            type="text" 
                                            id="Email" 
                                            placeholder="Email" 
                                            name="Email"
                                            aria-describedby="emailHelp" 
                                            maxlength="50"
                                            required>
                                        <br><br>
                                        <!-- Password inputs. Only password 1 is sent to the server -->
                                            <input class="form-control form-control-user" 
                                            type="password" 
                                            id="Password1" 
                                            placeholder="Password"
                                            name="Password1" 
                                            maxlength="30"
                                            required>
                                        <br><br>
                                            <input class="form-control form-control-user" 
                                            type="password" 
                                            id="Password2" 
                                            placeholder="Confirm Password"
                                            maxlength="30"
                                            required>
                                        <br><br>
                                        <!-- Submit button -->
                                        <button
                                        type="submit"
                                        class="btn btn-primary btn-user btn-block"
                                        onclick="checkPass();"
                                        id = "btnSub"
                                        >
                                        Create Account
                                        </button>   
                                        </body>
                                        </form>
                                        <hr />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- Footer-->
        <footer class="footer bg-light">
            <div class="container">
                <div class="row">
                    <div
                        class="col-lg-6 h-100 text-center text-lg-start my-auto"
                    >
                        <ul class="list-inline mb-2">
                            <li class="list-inline-item">
                                <a href="/">About</a>
                            </li>
                            <li class="list-inline-item">⋅</li>
                            <li class="list-inline-item">
                                <a href="contact">Contact</a>
                            </li>
                            <li class="list-inline-item">⋅</li>
                            <li class="list-inline-item">
                                <a href="termsOfUse">Terms of Use</a>
                            </li>
                        </ul>
                        <p class="text-muted small mb-4 mb-lg-0" id = Copyrite>
                        </p>
                    </div>
                    <div class="col-lg-6 h-100 text-center text-lg-end my-auto">
                        <ul class="list-inline mb-0">
                            <li class="list-inline-item me-4">
                                <a href="https://www.facebook.com/provocity/"
                                    ><i class="bi-facebook fs-3"></i
                                ></a>
                            </li>
                            <li class="list-inline-item me-4">
                                <a
                                    href="https://www.youtube.com/@ProvoCityGovernment"
                                    ><i class="bi-twitter fs-3"></i
                                ></a>
                            </li>
                            <li class="list-inline-item">
                                <a
                                    href="https://www.instagram.com/provocity/?hl=en"
                                    ><i class="bi-instagram fs-3"></i
                                ></a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </footer>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>
        <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
        <!-- * *                               SB Forms JS                               * *-->
        <!-- * * Activate your form at https://startbootstrap.com/solution/contact-forms * *-->
        <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
        <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>
        <script>
            /*This funciton will set up the page.
            Page setup includes determining the proper buttons to display based on login information,
            grabbing the current year to display on the copyright,
            and setting up the email error message.*/
            function setupPage()
            {
                let dDate = new Date();
                    dDate = dDate.getFullYear().toString();
                    document.getElementById("Copyrite").innerHTML = "&copy; Provo City " + dDate +". All Rights Reserved.";

                if (document.getElementById("emailBroke").innerText.includes("message"))
                {
                    document.getElementById("emailBroke").style.display = "none";
                }
                else
                {
                    document.getElementById("emailBroke").style.display = "block";
                }
            }

            /*This function is for email and password validation*/
            function checkPass(){
                let sPass1 = document.getElementById("Password1").value;
                let sPass2 = document.getElementById("Password2").value;
                let sEmail = document.getElementById("Email").value;

                //Email validation (very simple)
                if (sEmail.includes("@") && sEmail.includes("."))
                {
                    //Password validation
                    if (sPass1 !== sPass2)
                        {
                            document.getElementById("btnSub").type = "button";
                            document.getElementById("Password2").value = "";
                            document.getElementById("pwBroke").style.display = "block";
                            document.getElementById("emailBroke").style.display = "none";
                            document.getElementById("emailBroke2").style.display = "none";
                        }
                        else
                        {
                            document.getElementById("btnSub").type = "submit";
                            document.getElementById("pwBroke").style.display = "none";
                        }
                }
                else
                {
                    document.getElementById("btnSub").type = "button";
                    document.getElementById("Email").value = "";
                    document.getElementById("pwBroke").style.display = "none";
                    document.getElementById("emailBroke2").style.display = "block";
                }
            }

            /*This function auto-converts the first letter of a user's first and last name to upper case*/
            function properCaseInsert(oValue)
            {
                if (oValue.value.length === 1)
                {
                    oValue.value = oValue.value.charAt(0).toUpperCase();
                }
            }
        </script>
    </body>
</html>
